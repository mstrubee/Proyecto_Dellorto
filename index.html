<html lang="es"><head>
  <meta charset="UTF-8">
  <title>Cotizador de Productos y Rectificador</title>
  <!-- Librer√≠as externas: XLSX para Excel, jsPDF y jsPDF-autotable para PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
  <style>
    /* Estilos generales */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    .navbar {
      background: #333;
      color: white;
      padding: 15px;
      text-align: center;
    }
    .navbar a {
      color: white;
      text-decoration: none;
      margin: 0 15px;
      font-size: 18px;
    }
    .navbar a:hover {
      text-decoration: underline;
    }
    .container {
      padding: 20px;
      display: none;
    }
    .active {
      display: block;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      table-layout: auto;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: left;
      white-space: nowrap;
    }
    th {
      background-color: #f4f4f4;
    }
    .precio {
      text-align: right;
      cursor: pointer;
    }
    .precio::before {
      content: "$ ";
      float: left;
    }
    input, button, select {
      margin: 10px;
      padding: 8px;
    }
    
    /* Secci√≥n Productos */
    /* (Aqu√≠ puedes ajustar o agregar estilos propios) */
    
    /* Secci√≥n Rectificador */
    .project-info {
      font-size: 1.2em;
      margin-bottom: 10px;
    }
    input.project-input {
      font-size: 1em;
      width: 300px;
      padding: 4px;
      margin-bottom: 5px;
      display: block;
    }
    .btn-eliminar {
      background-color: red;
      color: white;
      border: none;
      padding: 4px;
      cursor: pointer;
      font-size: 0.9em;
    }
    /* Modal para exportaci√≥n */
    #modalGuardar {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
    }
    #modalGuardar .modal-content {
      background: #fff;
      padding: 20px;
      width: 300px;
      margin: 100px auto;
      text-align: center;
    }
    #modalGuardar .modal-content button {
      margin: 5px;
      padding: 6px;
    }
  </style>
</head>
<body>
  <!-- Men√∫ de navegaci√≥n -->
  <div class="navbar">
    <a href="#" onclick="mostrarSeccion('productos')">Lista de Productos</a>
    <a href="#" onclick="mostrarSeccion('cotizador')">Cotizador</a>
    <a href="#" onclick="mostrarSeccion('historial')">Historial</a>
    <a href="#" onclick="mostrarSeccion('configuracion')">Configuraci√≥n</a>
    <a href="#" onclick="mostrarSeccion('rectificador')">Rectificador</a>
  </div>

  <!-- Secci√≥n de Productos -->
  <div id="productos" class="container active">
    <h2>Lista de Productos</h2>
    <label for="filtroCategoria">Filtrar por categor√≠a:</label>
    <select id="filtroCategoria" onchange="filtrarProductos()"><option value="todos">Todas</option><option value="Vidrios">Vidrios</option><option value="Separadores">Separadores</option><option value="Accesorios">Accesorios</option><option value="Terminaciones">Terminaciones</option><option value="Perforado">Perforado</option><option value="Adicionales">Adicionales</option><option value="Otros">Otros</option></select>

    <label for="filtroEspesor">Filtrar por espesor:</label>
    <select id="filtroEspesor" onchange="filtrarProductos()"><option value="todos">Todos</option><option value="0">0 mm</option><option value="0.1">0.1 mm</option><option value="0.15">0.15 mm</option><option value="4">4 mm</option><option value="5">5 mm</option><option value="6">6 mm</option><option value="8">8 mm</option><option value="9">9 mm</option><option value="10">10 mm</option><option value="12">12 mm</option><option value="13">13 mm</option><option value="15">15 mm</option><option value="16">16 mm</option><option value="17">17 mm</option><option value="18">18 mm</option><option value="19">19 mm</option><option value="20">20 mm</option></select>

    <input type="file" id="fileInput" accept=".xlsx, .xls">
    <button onclick="procesarExcel()">Cargar Excel</button>
    <button onclick="descargarExcel()">Descargar Excel</button>
    <button onclick="descargarHTML()">Descargar HTML</button>
    <button onclick="guardarDatos()">Guardar Productos</button>
    <div id="listaProductos"><table>
                        <tbody><tr>
                          <th>Categor√≠a</th>
                          <th>Producto</th>
                          <th>Espesor (mm)</th>
                          <th>Precio</th>
                        </tr><tr>
                        <td>Vidrios</td>
                        <td>Incoloro</td>
                        <td>4</td>
                        <td class="precio editable" onclick="editarPrecio(0)">
                          2.550
                        </td>
                      </tr><tr>
                        <td>Vidrios</td>
                        <td>Incoloro</td>
                        <td>5</td>
                        <td class="precio editable" onclick="editarPrecio(1)">
                          12.000
                        </td>
                      </tr><tr>
                        <td>Vidrios</td>
                        <td>Incoloro</td>
                        <td>6</td>
                        <td class="precio editable" onclick="editarPrecio(2)">
                          14.000
                        </td>
                      </tr><tr>
                        <td>Vidrios</td>
                        <td>Incoloro</td>
                        <td>8</td>
                        <td class="precio editable" onclick="editarPrecio(3)">
                          16.000
                        </td>
                      </tr><tr>
                        <td>Vidrios</td>
                        <td>Incoloro</td>
                        <td>10</td>
                        <td class="precio editable" onclick="editarPrecio(4)">
                          18.000
                        </td>
                      </tr><tr>
                        <td>Vidrios</td>
                        <td>Incoloro</td>
                        <td>12</td>
                        <td class="precio editable" onclick="editarPrecio(5)">
                          20.000
                        </td>
                      </tr><tr>
                        <td>Vidrios</td>
                        <td>Mateluz</td>
                        <td>4</td>
                        <td class="precio editable" onclick="editarPrecio(6)">
                          11.000
                        </td>
                      </tr><tr>
                        <td>Vidrios</td>
                        <td>Mateluz</td>
                        <td>5</td>
                        <td class="precio editable" onclick="editarPrecio(7)">
                          13.000
                        </td>
                      </tr><tr>
                        <td>Vidrios</td>
                        <td>Mateluz</td>
                        <td>6</td>
                        <td class="precio editable" onclick="editarPrecio(8)">
                          15.000
                        </td>
                      </tr><tr>
                        <td>Vidrios</td>
                        <td>Templado</td>
                        <td>4</td>
                        <td class="precio editable" onclick="editarPrecio(9)">
                          20.000
                        </td>
                      </tr><tr>
                        <td>Vidrios</td>
                        <td>Templado</td>
                        <td>5</td>
                        <td class="precio editable" onclick="editarPrecio(10)">
                          22.000
                        </td>
                      </tr><tr>
                        <td>Vidrios</td>
                        <td>Templado</td>
                        <td>6</td>
                        <td class="precio editable" onclick="editarPrecio(11)">
                          24.000
                        </td>
                      </tr><tr>
                        <td>Vidrios</td>
                        <td>Templado</td>
                        <td>8</td>
                        <td class="precio editable" onclick="editarPrecio(12)">
                          26.000
                        </td>
                      </tr><tr>
                        <td>Vidrios</td>
                        <td>Templado</td>
                        <td>10</td>
                        <td class="precio editable" onclick="editarPrecio(13)">
                          28.000
                        </td>
                      </tr><tr>
                        <td>Vidrios</td>
                        <td>Templado</td>
                        <td>12</td>
                        <td class="precio editable" onclick="editarPrecio(14)">
                          30.000
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador polisulfuro</td>
                        <td>6</td>
                        <td class="precio editable" onclick="editarPrecio(15)">
                          2.180
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador polisulfuro</td>
                        <td>8</td>
                        <td class="precio editable" onclick="editarPrecio(16)">
                          2.180
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador polisulfuro</td>
                        <td>9</td>
                        <td class="precio editable" onclick="editarPrecio(17)">
                          2.180
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador polisulfuro</td>
                        <td>10</td>
                        <td class="precio editable" onclick="editarPrecio(18)">
                          2.180
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador polisulfuro</td>
                        <td>12</td>
                        <td class="precio editable" onclick="editarPrecio(19)">
                          2.180
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador polisulfuro</td>
                        <td>13</td>
                        <td class="precio editable" onclick="editarPrecio(20)">
                          3.758,32
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador polisulfuro</td>
                        <td>15</td>
                        <td class="precio editable" onclick="editarPrecio(21)">
                          3.758,32
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador polisulfuro</td>
                        <td>16</td>
                        <td class="precio editable" onclick="editarPrecio(22)">
                          3.845,52
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador polisulfuro</td>
                        <td>17</td>
                        <td class="precio editable" onclick="editarPrecio(23)">
                          3.845,52
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador polisulfuro</td>
                        <td>18</td>
                        <td class="precio editable" onclick="editarPrecio(24)">
                          3.845,52
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador polisulfuro</td>
                        <td>19</td>
                        <td class="precio editable" onclick="editarPrecio(25)">
                          3.845,52
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador polisulfuro</td>
                        <td>20</td>
                        <td class="precio editable" onclick="editarPrecio(26)">
                          3.845,52
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador silicona estructural negra</td>
                        <td>6</td>
                        <td class="precio editable" onclick="editarPrecio(27)">
                          4.708,8
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador silicona estructural negra</td>
                        <td>8</td>
                        <td class="precio editable" onclick="editarPrecio(28)">
                          4.708,8
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador silicona estructural negra</td>
                        <td>9</td>
                        <td class="precio editable" onclick="editarPrecio(29)">
                          4.708,8
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador silicona estructural negra</td>
                        <td>10</td>
                        <td class="precio editable" onclick="editarPrecio(30)">
                          4.708,8
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador silicona estructural negra</td>
                        <td>12</td>
                        <td class="precio editable" onclick="editarPrecio(31)">
                          4.708,8
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador silicona estructural negra</td>
                        <td>13</td>
                        <td class="precio editable" onclick="editarPrecio(32)">
                          5.406,4
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador silicona estructural negra</td>
                        <td>15</td>
                        <td class="precio editable" onclick="editarPrecio(33)">
                          5.406,4
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador silicona estructural negra</td>
                        <td>16</td>
                        <td class="precio editable" onclick="editarPrecio(34)">
                          5.694,16
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador silicona estructural negra</td>
                        <td>17</td>
                        <td class="precio editable" onclick="editarPrecio(35)">
                          5.694,16
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador silicona estructural negra</td>
                        <td>18</td>
                        <td class="precio editable" onclick="editarPrecio(36)">
                          5.694,16
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador silicona estructural negra</td>
                        <td>19</td>
                        <td class="precio editable" onclick="editarPrecio(37)">
                          5.694,16
                        </td>
                      </tr><tr>
                        <td>Separadores</td>
                        <td>Separador silicona estructural negra</td>
                        <td>20</td>
                        <td class="precio editable" onclick="editarPrecio(38)">
                          5.694,16
                        </td>
                      </tr><tr>
                        <td>Accesorios</td>
                        <td>Laminado 33,1</td>
                        <td>6</td>
                        <td class="precio editable" onclick="editarPrecio(39)">
                          26.552,4
                        </td>
                      </tr><tr>
                        <td>Accesorios</td>
                        <td>Laminado 44,1</td>
                        <td>8</td>
                        <td class="precio editable" onclick="editarPrecio(40)">
                          31.801,84
                        </td>
                      </tr><tr>
                        <td>Accesorios</td>
                        <td>Laminado 55,1</td>
                        <td>10</td>
                        <td class="precio editable" onclick="editarPrecio(41)">
                          37.452,4
                        </td>
                      </tr><tr>
                        <td>Accesorios</td>
                        <td>Laminado 66,1</td>
                        <td>12</td>
                        <td class="precio editable" onclick="editarPrecio(42)">
                          46.416,56
                        </td>
                      </tr><tr>
                        <td>Accesorios</td>
                        <td>Laminado 33,2</td>
                        <td>6</td>
                        <td class="precio editable" onclick="editarPrecio(43)">
                          37.260,56
                        </td>
                      </tr><tr>
                        <td>Accesorios</td>
                        <td>Laminado  44,2</td>
                        <td>8</td>
                        <td class="precio editable" onclick="editarPrecio(44)">
                          43.739,52
                        </td>
                      </tr><tr>
                        <td>Accesorios</td>
                        <td>Laminado  55,2</td>
                        <td>10</td>
                        <td class="precio editable" onclick="editarPrecio(45)">
                          48.273,92
                        </td>
                      </tr><tr>
                        <td>Accesorios</td>
                        <td>Laminado  66,2</td>
                        <td>12</td>
                        <td class="precio editable" onclick="editarPrecio(46)">
                          53.915,76
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido opaco</td>
                        <td>4</td>
                        <td class="precio editable" onclick="editarPrecio(47)">
                          680,16
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido opaco</td>
                        <td>5</td>
                        <td class="precio editable" onclick="editarPrecio(48)">
                          680,16
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido opaco</td>
                        <td>6</td>
                        <td class="precio editable" onclick="editarPrecio(49)">
                          680,16
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido opaco</td>
                        <td>8</td>
                        <td class="precio editable" onclick="editarPrecio(50)">
                          1.281,84
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido opaco</td>
                        <td>10</td>
                        <td class="precio editable" onclick="editarPrecio(51)">
                          1.281,84
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido opaco</td>
                        <td>12</td>
                        <td class="precio editable" onclick="editarPrecio(52)">
                          1.281,84
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido opaco laminado 33,1</td>
                        <td>-</td>
                        <td class="precio editable" onclick="editarPrecio(53)">
                          1.412,64
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido opaco laminado 44,1</td>
                        <td>-</td>
                        <td class="precio editable" onclick="editarPrecio(54)">
                          1.709,12
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido opaco laminado 55,1</td>
                        <td>-</td>
                        <td class="precio editable" onclick="editarPrecio(55)">
                          2.005,6
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido opaco laminado 66,1</td>
                        <td>-</td>
                        <td class="precio editable" onclick="editarPrecio(56)">
                          2.197,44
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido brillante</td>
                        <td>4</td>
                        <td class="precio editable" onclick="editarPrecio(57)">
                          1.273,12
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido brillante</td>
                        <td>5</td>
                        <td class="precio editable" onclick="editarPrecio(58)">
                          1.273,12
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido brillante</td>
                        <td>6</td>
                        <td class="precio editable" onclick="editarPrecio(59)">
                          1.273,12
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido brillante</td>
                        <td>8</td>
                        <td class="precio editable" onclick="editarPrecio(60)">
                          1.761,44
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido brillante</td>
                        <td>10</td>
                        <td class="precio editable" onclick="editarPrecio(61)">
                          1.761,44
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido brillante</td>
                        <td>12</td>
                        <td class="precio editable" onclick="editarPrecio(62)">
                          1.761,44
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido brillante</td>
                        <td>15</td>
                        <td class="precio editable" onclick="editarPrecio(63)">
                          3.958,88
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido brillante</td>
                        <td>16</td>
                        <td class="precio editable" onclick="editarPrecio(64)">
                          3.958,88
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido brillante</td>
                        <td>17</td>
                        <td class="precio editable" onclick="editarPrecio(65)">
                          3.958,88
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido brillante</td>
                        <td>18</td>
                        <td class="precio editable" onclick="editarPrecio(66)">
                          3.958,88
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido brillante</td>
                        <td>19</td>
                        <td class="precio editable" onclick="editarPrecio(67)">
                          3.958,88
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido brillante laminado 33,1</td>
                        <td>-</td>
                        <td class="precio editable" onclick="editarPrecio(68)">
                          2.005,6
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido brillante laminado 44,1</td>
                        <td>-</td>
                        <td class="precio editable" onclick="editarPrecio(69)">
                          2.293,36
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido brillante laminado 55,1</td>
                        <td>-</td>
                        <td class="precio editable" onclick="editarPrecio(70)">
                          2.589,84
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Pulido brillante laminado 66,1</td>
                        <td>-</td>
                        <td class="precio editable" onclick="editarPrecio(71)">
                          2.877,6
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Botado arista</td>
                        <td>4</td>
                        <td class="precio editable" onclick="editarPrecio(72)">
                          261,6
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Botado arista</td>
                        <td>5</td>
                        <td class="precio editable" onclick="editarPrecio(73)">
                          261,6
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Botado arista</td>
                        <td>6</td>
                        <td class="precio editable" onclick="editarPrecio(74)">
                          261,6
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Botado arista</td>
                        <td>8</td>
                        <td class="precio editable" onclick="editarPrecio(75)">
                          872
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Botado arista</td>
                        <td>10</td>
                        <td class="precio editable" onclick="editarPrecio(76)">
                          872
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Botado arista x tp</td>
                        <td>4</td>
                        <td class="precio editable" onclick="editarPrecio(77)">
                          523,2
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Botado arista x tp</td>
                        <td>5</td>
                        <td class="precio editable" onclick="editarPrecio(78)">
                          523,2
                        </td>
                      </tr><tr>
                        <td>Terminaciones</td>
                        <td>Botado arista x tp</td>
                        <td>6</td>
                        <td class="precio editable" onclick="editarPrecio(79)">
                          523,2
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Perforado normal</td>
                        <td>4</td>
                        <td class="precio editable" onclick="editarPrecio(80)">
                          1.369,04
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Perforado normal</td>
                        <td>5</td>
                        <td class="precio editable" onclick="editarPrecio(81)">
                          1.369,04
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Perforado normal</td>
                        <td>6</td>
                        <td class="precio editable" onclick="editarPrecio(82)">
                          1.369,04
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Perforado normal</td>
                        <td>8</td>
                        <td class="precio editable" onclick="editarPrecio(83)">
                          1.369,04
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Perforado normal</td>
                        <td>10</td>
                        <td class="precio editable" onclick="editarPrecio(84)">
                          1.369,04
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Perforado normal</td>
                        <td>12</td>
                        <td class="precio editable" onclick="editarPrecio(85)">
                          1.369,04
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Perforado normal</td>
                        <td>15</td>
                        <td class="precio editable" onclick="editarPrecio(86)">
                          4.830,88
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Perforado normal</td>
                        <td>16</td>
                        <td class="precio editable" onclick="editarPrecio(87)">
                          4.830,88
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Perforado normal</td>
                        <td>17</td>
                        <td class="precio editable" onclick="editarPrecio(88)">
                          4.830,88
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Perforado normal</td>
                        <td>18</td>
                        <td class="precio editable" onclick="editarPrecio(89)">
                          4.830,88
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Perforado normal</td>
                        <td>19</td>
                        <td class="precio editable" onclick="editarPrecio(90)">
                          4.830,88
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Perforado avellanado</td>
                        <td>4</td>
                        <td class="precio editable" onclick="editarPrecio(91)">
                          3.147,92
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Perforado avellanado</td>
                        <td>5</td>
                        <td class="precio editable" onclick="editarPrecio(92)">
                          3.147,92
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Perforado avellanado</td>
                        <td>6</td>
                        <td class="precio editable" onclick="editarPrecio(93)">
                          3.147,92
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Perforado avellanado</td>
                        <td>8</td>
                        <td class="precio editable" onclick="editarPrecio(94)">
                          3.147,92
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Perforado avellanado</td>
                        <td>10</td>
                        <td class="precio editable" onclick="editarPrecio(95)">
                          3.147,92
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Perforado avellanado</td>
                        <td>12</td>
                        <td class="precio editable" onclick="editarPrecio(96)">
                          3.147,92
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Destajado normal</td>
                        <td>4</td>
                        <td class="precio editable" onclick="editarPrecio(97)">
                          1.700,4
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Destajado normal</td>
                        <td>5</td>
                        <td class="precio editable" onclick="editarPrecio(98)">
                          1.700,4
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Destajado normal</td>
                        <td>6</td>
                        <td class="precio editable" onclick="editarPrecio(99)">
                          1.700,4
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Destajado normal</td>
                        <td>8</td>
                        <td class="precio editable" onclick="editarPrecio(100)">
                          1.700,4
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Destajado normal</td>
                        <td>10</td>
                        <td class="precio editable" onclick="editarPrecio(101)">
                          1.700,4
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Destajado normal</td>
                        <td>12</td>
                        <td class="precio editable" onclick="editarPrecio(102)">
                          1.700,4
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Destajado central</td>
                        <td>4</td>
                        <td class="precio editable" onclick="editarPrecio(103)">
                          17.736
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Destajado central</td>
                        <td>5</td>
                        <td class="precio editable" onclick="editarPrecio(104)">
                          17.736
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Destajado central</td>
                        <td>6</td>
                        <td class="precio editable" onclick="editarPrecio(105)">
                          17.736
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Destajado central</td>
                        <td>8</td>
                        <td class="precio editable" onclick="editarPrecio(106)">
                          17.736
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Destajado central</td>
                        <td>10</td>
                        <td class="precio editable" onclick="editarPrecio(107)">
                          17.736
                        </td>
                      </tr><tr>
                        <td>Perforado</td>
                        <td>Destajado central</td>
                        <td>12</td>
                        <td class="precio editable" onclick="editarPrecio(108)">
                          17.736
                        </td>
                      </tr><tr>
                        <td>Adicionales</td>
                        <td>Formas Trapezoidal</td>
                        <td>0.15</td>
                        <td class="precio editable" onclick="editarPrecio(109)">
                          0
                        </td>
                      </tr><tr>
                        <td>Adicionales</td>
                        <td>Formas medios puntos</td>
                        <td>0.15</td>
                        <td class="precio editable" onclick="editarPrecio(110)">
                          0
                        </td>
                      </tr><tr>
                        <td>Adicionales</td>
                        <td>Planitherm 1.3T</td>
                        <td>4</td>
                        <td class="precio editable" onclick="editarPrecio(111)">
                          15.103,04
                        </td>
                      </tr><tr>
                        <td>Adicionales</td>
                        <td>Planitherm 1.3T </td>
                        <td>5</td>
                        <td class="precio editable" onclick="editarPrecio(112)">
                          19.297,36
                        </td>
                      </tr><tr>
                        <td>Adicionales</td>
                        <td>Planitherm 1.3T</td>
                        <td>6</td>
                        <td class="precio editable" onclick="editarPrecio(113)">
                          22.488,88
                        </td>
                      </tr><tr>
                        <td>Adicionales</td>
                        <td>Pintura Serigraf√≠a 100% o dise√±o (existiendo el bastidor)</td>
                        <td>-</td>
                        <td class="precio editable" onclick="editarPrecio(114)">
                          15.390,8
                        </td>
                      </tr><tr>
                        <td>Adicionales</td>
                        <td>Serigraf√≠a Digital</td>
                        <td>-</td>
                        <td class="precio editable" onclick="editarPrecio(115)">
                          62.696,8
                        </td>
                      </tr><tr>
                        <td>Accesorios</td>
                        <td>Gas arg√≥n</td>
                        <td>-</td>
                        <td class="precio editable" onclick="editarPrecio(116)">
                          1.464,96
                        </td>
                      </tr><tr>
                        <td>Accesorios</td>
                        <td>V√°lvula (unidad)</td>
                        <td>-</td>
                        <td class="precio editable" onclick="editarPrecio(117)">
                          1.464,96
                        </td>
                      </tr><tr>
                        <td>Otros</td>
                        <td>Desplace 1 cara</td>
                        <td>0.1</td>
                        <td class="precio editable" onclick="editarPrecio(118)">
                          0
                        </td>
                      </tr></tbody></table></div>
  </div>

  <!-- Secci√≥n Cotizador (opcional) -->
  <div id="cotizador" class="container">
    <h2>Cotizador</h2>
    <!-- Contenido del cotizador -->
  </div>

  <!-- Secci√≥n Historial (opcional) -->
  <div id="historial" class="container">
    <h2>Historial</h2>
    <!-- Contenido del historial -->
  </div>

  <!-- Secci√≥n Configuraci√≥n (opcional) -->
  <div id="configuracion" class="container">
    <h2>Configuraci√≥n</h2>
    <!-- Contenido de configuraci√≥n -->
  </div>

  <!-- Secci√≥n Rectificador -->
  <div id="rectificador" class="container">
    <h2>Rectificaci√≥n</h2>
    <!-- √Årea para ingresar datos del proyecto -->
    <div class="project-info">
      <input type="text" id="nombreProyecto" class="project-input" value="nombre del proyecto" onfocus="if(this.value=='nombre del proyecto') this.value='';" onblur="if(this.value=='') this.value='nombre del proyecto';">
      <input type="text" id="codigoProyecto" class="project-input" value="codigo del proyecto" onfocus="if(this.value=='codigo del proyecto') this.value='';" onblur="if(this.value=='') this.value='codigo del proyecto';">
    </div>

    <table>
      <tbody><tr>
        <th>Eliminar</th>
        <th>Elemento</th>
        <th>Tipo</th>
        <th>Nombre</th>
        <th>Cantidad</th>
        <th>Ancho (mm)</th>
        <th>Alto (mm)</th>
        <th>Asentamiento (mm)</th>
        <th>m¬≤</th>
        <th>mL</th>
      </tr>
      </tbody><tbody id="tablaRectificacion"><tr><td><button class="btn-eliminar">üóëÔ∏è</button></td><td><select><option value="" disabled="" style="color: red;">Seleccione</option><option value="Accesorios">Accesorios</option><option value="Adicionales">Adicionales</option><option value="Otros">Otros</option><option value="Perforado">Perforado</option><option value="Separadores">Separadores</option><option value="Terminaciones">Terminaciones</option><option value="Ventana">Ventana</option><option value="Vidrios">Vidrios</option></select></td><td><select><option value="" disabled="" style="color: red;">Seleccione</option><option value="Abatir Exterior">Abatir Exterior</option><option value="Abatir Interior">Abatir Interior</option><option value="Baranda">Baranda</option><option value="Baranda Banquina">Baranda Banquina</option><option value="Baranda Botones (perforado)">Baranda Botones (perforado)</option><option value="Corredera">Corredera</option><option value="Cortina Cristal">Cortina Cristal</option><option value="Espejo">Espejo</option><option value="Guillotina">Guillotina</option><option value="Lucarnas">Lucarnas</option><option value="Mampara">Mampara</option><option value="Oscilobatiente">Oscilobatiente</option><option value="Proyectante">Proyectante</option><option value="Puerta Protex">Puerta Protex</option><option value="Puerta/Ventana">Puerta/Ventana</option><option value="Shower">Shower</option><option value="Ventana Fija">Ventana Fija</option><option value="Ventana Pleagable">Ventana Pleagable</option></select></td><td><input type="text"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td><td id="m2-0">0.00 m¬≤</td><td id="ml-0">0.00 m</td></tr></tbody>
    </table>

    <button onclick="agregarFila()">Agregar Fila</button>
    <button onclick="mostrarOpcionesGuardar()">Guardar Rectificaci√≥n</button>

    <!-- Modal para exportaci√≥n -->
    <div id="modalGuardar">
      <div class="modal-content">
        <h3>Guardar como:</h3>
        <button onclick="exportarPDF()">PDF</button>
        <button onclick="exportarExcel()">Excel</button>
        <button onclick="exportarHTML()">HTML</button>
        <button onclick="cerrarModalGuardar()">Cancelar</button>
      </div>
    </div>
  </div>

  <script>
    /* ------------------------------------------------- */
    /*        Funcionalidades de Productos             */
    /* ------------------------------------------------- */
    // Se carga la informaci√≥n de productos desde localStorage o se inicia en vac√≠o.
    let productos = JSON.parse(localStorage.getItem("productos")) || [];

    function inicializarFiltros() {
      const filtroCategoria = document.getElementById("filtroCategoria");
      const filtroEspesor = document.getElementById("filtroEspesor");

      const categorias = [...new Set(productos.map(p => p.categoria))];
      const espesores = [...new Set(productos.map(p => p.espesor).filter(e => e !== null))];

      filtroCategoria.innerHTML = '<option value="todos">Todas</option>';
      filtroEspesor.innerHTML = '<option value="todos">Todos</option>';

      categorias.forEach(categoria => {
        const opcion = document.createElement("option");
        opcion.value = categoria;
        opcion.textContent = categoria;
        filtroCategoria.appendChild(opcion);
      });

      espesores.sort((a, b) => a - b).forEach(espesor => {
        const opcion = document.createElement("option");
        opcion.value = espesor;
        opcion.textContent = espesor + " mm";
        filtroEspesor.appendChild(opcion);
      });
    }

    function mostrarProductos() {
      let tablaHTML = `<table>
                        <tr>
                          <th>Categor√≠a</th>
                          <th>Producto</th>
                          <th>Espesor (mm)</th>
                          <th>Precio</th>
                        </tr>`;

      const categoriaSeleccionada = document.getElementById("filtroCategoria").value;
      const espesorSeleccionado = document.getElementById("filtroEspesor").value;

      const listaFiltrada = productos.filter(p =>
        (categoriaSeleccionada === "todos" || p.categoria === categoriaSeleccionada) &&
        (espesorSeleccionado === "todos" || p.espesor == espesorSeleccionado)
      );

      // Se obtiene el √≠ndice real en el array original para editar el precio.
      listaFiltrada.forEach(producto => {
        const indiceReal = productos.indexOf(producto);
        // Se verifica que "precio" exista y se convierte a n√∫mero; si no, se muestra "0".
        const precioValor = (producto.precio !== undefined &&
                             producto.precio !== null &&
                             producto.precio !== "") 
                             ? Number(producto.precio) 
                             : 0;
        const precioMostrar = precioValor.toLocaleString("es-CL");
        tablaHTML += `<tr>
                        <td>${producto.categoria}</td>
                        <td>${producto.nombre}</td>
                        <td>${producto.espesor ? producto.espesor : "-"}</td>
                        <td class="precio editable" onclick="editarPrecio(${indiceReal})">
                          ${precioMostrar}
                        </td>
                      </tr>`;
      });

      tablaHTML += `</table>`;
      document.getElementById("listaProductos").innerHTML = tablaHTML;
    }

    function editarPrecio(index) {
      const precioActual = productos[index].precio !== undefined ? productos[index].precio : 0;
      const nuevoPrecio = prompt("Ingresa el nuevo precio para " +
        productos[index].nombre + " " + productos[index].espesor + "mm:", precioActual);
      if (nuevoPrecio !== null && !isNaN(nuevoPrecio)) {
        productos[index].precio = parseFloat(nuevoPrecio);
        localStorage.setItem("productos", JSON.stringify(productos));
        mostrarProductos();
      } else {
        alert("Por favor, ingresa un n√∫mero v√°lido.");
      }
    }

    function descargarExcel() {
      const hoja = XLSX.utils.json_to_sheet(productos);
      const libro = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(libro, hoja, "Productos");
      XLSX.writeFile(libro, "productos.xlsx");
    }

    function descargarHTML() {
      const contenidoHTML = document.documentElement.outerHTML;
      const blob = new Blob([contenidoHTML], { type: "text/html" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "productos_completos.html";
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    function guardarDatos() {
      localStorage.setItem("productos", JSON.stringify(productos));
      alert("Los productos han sido guardados correctamente.");
    }

    function filtrarProductos() {
      mostrarProductos();
    }

    // Funci√≥n para procesar el archivo Excel y cargar productos.
function procesarExcel() {
  const input = document.getElementById("fileInput");
  if (!input.files || !input.files[0]) {
    alert("Por favor, selecciona un archivo Excel.");
    return;
  }
  const file = input.files[0];
  const reader = new FileReader();
  reader.onload = function(e) {
    const data = new Uint8Array(e.target.result);
    const workbook = XLSX.read(data, { type: "array" });
    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
    let excelJSON = XLSX.utils.sheet_to_json(firstSheet, { defval: "" });

    const productosNormalizados = excelJSON.map(item => {
      const newItem = {};
      for (let key in item) {
        // Convertimos todas las claves a min√∫sculas y eliminamos espacios innecesarios
        newItem[key.trim().toLowerCase()] = item[key];
      }
      // Asegurarse de que "categor√≠a" y "producto" est√©n correctamente asignados
      newItem.categoria = newItem["categor√≠a"] || newItem["categoria"] || "Sin categor√≠a";
      newItem.nombre = newItem["producto"] || newItem["nombre"] || "Sin nombre";
      newItem.espesor = newItem["espesor"] ? parseFloat(newItem["espesor"]) || 0 : 0;
      newItem.precio = newItem["precio"] ? parseFloat(newItem["precio"]) || 0 : 0;

      return newItem;
    });

    productos = productosNormalizados;
    localStorage.setItem("productos", JSON.stringify(productos));
    inicializarFiltros();
    mostrarProductos();
  };
  reader.readAsArrayBuffer(file);
}

    // Inicializaci√≥n de Productos
    inicializarFiltros();
    mostrarProductos();

    /* ------------------------------------------------- */
    /*       Funcionalidades de Rectificador             */
    /* ------------------------------------------------- */
    // Se carga la informaci√≥n de rectificaciones desde localStorage.
    let rectificaciones = JSON.parse(localStorage.getItem("rectificaciones")) || [];
    
    // Opciones para el desplegable "Tipo"
    const opcionesTipo = [
      "Corredera",
      "Guillotina",
      "Proyectante",
      "Oscilobatiente",
      "Ventana Fija",
      "Baranda",
      "Puerta/Ventana",
      "Abatir Interior",
      "Abatir Exterior",
      "Ventana Pleagable",
      "Cortina Cristal",
      "Baranda Banquina",
      "Baranda Botones (perforado)",
      "Lucarnas",
      "Shower",
      "Espejo",
      "Mampara",
      "Puerta Protex"
    ];
    
    function inicializarRectificacion() {
      let categorias = [...new Set(productos.map(p => p.categoria))];
      if (!categorias.includes("Ventana")) { categorias.push("Ventana"); }
      categorias.sort((a, b) => a.localeCompare(b));
      actualizarTablaRectificacion(categorias);
    }
    
    function actualizarTablaRectificacion(categorias) {
      const tabla = document.getElementById("tablaRectificacion");
      tabla.innerHTML = "";
      
      rectificaciones.forEach((rectificacion, index) => {
        const fila = document.createElement("tr");
    
        // Columna de eliminaci√≥n
        const celdaEliminar = document.createElement("td");
        const botonEliminar = document.createElement("button");
        botonEliminar.textContent = "üóëÔ∏è";
        botonEliminar.className = "btn-eliminar";
        botonEliminar.onclick = () => eliminarFila(index);
        celdaEliminar.appendChild(botonEliminar);
        fila.appendChild(celdaEliminar);
    
        // Columna "Elemento": desplegable
        const celdaElemento = document.createElement("td");
        const selectElemento = document.createElement("select");
        const defaultOptionElem = document.createElement("option");
        defaultOptionElem.value = "";
        defaultOptionElem.textContent = "Seleccione";
        defaultOptionElem.style.color = "red";
        defaultOptionElem.disabled = true;
        if (!rectificaciones[index].elemento) { defaultOptionElem.selected = true; }
        selectElemento.appendChild(defaultOptionElem);
        categorias.forEach(categoria => {
          const opcion = document.createElement("option");
          opcion.value = categoria;
          opcion.textContent = categoria;
          if (categoria === rectificaciones[index].elemento) { opcion.selected = true; }
          selectElemento.appendChild(opcion);
        });
        selectElemento.onchange = () => {
          rectificaciones[index].elemento = selectElemento.value;
          guardarRectificacion();
        };
        celdaElemento.appendChild(selectElemento);
        fila.appendChild(celdaElemento);
    
        // Columna "Tipo": desplegable
        const celdaTipo = document.createElement("td");
        const selectTipo = document.createElement("select");
        const defaultOption = document.createElement("option");
        defaultOption.value = "";
        defaultOption.textContent = "Seleccione";
        defaultOption.style.color = "red";
        defaultOption.disabled = true;
        if (!rectificaciones[index].tipo) { defaultOption.selected = true; }
        selectTipo.appendChild(defaultOption);
        const sortedTipos = opcionesTipo.slice().sort((a, b) => a.localeCompare(b));
        sortedTipos.forEach(tipoOption => {
          const opt = document.createElement("option");
          opt.value = tipoOption;
          opt.textContent = tipoOption;
          if (tipoOption === rectificaciones[index].tipo) { opt.selected = true; }
          selectTipo.appendChild(opt);
        });
        selectTipo.onchange = () => {
          rectificaciones[index].tipo = selectTipo.value;
          guardarRectificacion();
        };
        celdaTipo.appendChild(selectTipo);
        fila.appendChild(celdaTipo);
    
        // Columnas "Nombre", "Cantidad", "Ancho", "Alto" y "Asentamiento" mediante inputs.
        fila.appendChild(crearCeldaInput("text", rectificaciones[index].nombre, index, "nombre"));
        fila.appendChild(crearCeldaInput("number", rectificaciones[index].cantidad, index, "cantidad"));
        fila.appendChild(crearCeldaInput("number", rectificaciones[index].ancho, index, "ancho"));
        fila.appendChild(crearCeldaInput("number", rectificaciones[index].alto, index, "alto"));
        fila.appendChild(crearCeldaInput("number", rectificaciones[index].asentamiento, index, "asentamiento"));
    
        // Columna para m¬≤
        const celdaM2 = document.createElement("td");
        celdaM2.id = `m2-${index}`;
        celdaM2.textContent = calcularM2(rectificaciones[index].ancho, rectificaciones[index].alto, rectificaciones[index].asentamiento) + " m¬≤";
        fila.appendChild(celdaM2);
    
        // Columna para mL
        const celdaML = document.createElement("td");
        celdaML.id = `ml-${index}`;
        celdaML.textContent = calcularML(rectificaciones[index].ancho, rectificaciones[index].alto, rectificaciones[index].asentamiento) + " m";
        fila.appendChild(celdaML);
    
        tabla.appendChild(fila);
      });
    }
    
    // Funci√≥n gen√©rica para crear una celda con input.
    function crearCeldaInput(tipo, valor, indice, propiedad) {
      const celda = document.createElement("td");
      const input = document.createElement("input");
      input.type = tipo;
      input.value = (valor !== undefined && valor !== null) ? valor : "";
      
      if (["ancho", "alto", "asentamiento"].includes(propiedad)) {
        input.addEventListener("focus", function() {
          if (input.value === "0") { input.value = ""; }
        });
      }
      
      input.oninput = function(event) {
        if (["cantidad", "ancho", "alto", "asentamiento"].includes(propiedad)) {
          rectificaciones[indice][propiedad] = parseFloat(event.target.value) || 0;
          actualizarCalculosSinRedibujar(indice);
        } else {
          rectificaciones[indice][propiedad] = event.target.value;
        }
      };
      celda.appendChild(input);
      return celda;
    }
    
    // Funciones para calcular m¬≤ y mL.
    function calcularM2(ancho, alto, asentamiento) {
      const a = parseFloat(ancho) || 0;
      const h = parseFloat(alto) || 0;
      const asen = parseFloat(asentamiento) || 0;
      return ((a * (h + asen)) / 1000000).toFixed(2);
    }
    
    function calcularML(ancho, alto, asentamiento) {
      const a = parseFloat(ancho) || 0;
      const h = parseFloat(alto) || 0;
      const asen = parseFloat(asentamiento) || 0;
      return (((a * 2) + ((h + asen) * 2)) / 1000).toFixed(2);
    }
    
    // Actualiza los c√°lculos sin redibujar toda la tabla.
    function actualizarCalculosSinRedibujar(index) {
      const rectificacion = rectificaciones[index];
      rectificacion.m2 = calcularM2(rectificacion.ancho, rectificacion.alto, rectificacion.asentamiento);
      rectificacion.ml = calcularML(rectificacion.ancho, rectificacion.alto, rectificacion.asentamiento);
      const celdaM2 = document.getElementById(`m2-${index}`);
      const celdaML = document.getElementById(`ml-${index}`);
      if (celdaM2) celdaM2.textContent = rectificacion.m2 + " m¬≤";
      if (celdaML) celdaML.textContent = rectificacion.ml + " m";
      guardarRectificacion();
    }
    
    // Agrega una nueva fila con valores predeterminados.
    function agregarFila() {
      rectificaciones.push({
        elemento: "",
        tipo: "",
        nombre: "",
        cantidad: 1,
        ancho: 0,
        alto: 0,
        asentamiento: 0,
        m2: "0.00",
        ml: "0.00"
      });
      guardarRectificacion();
      inicializarRectificacion();
    }
    
    // Elimina la fila indicada.
    function eliminarFila(index) {
      rectificaciones.splice(index, 1);
      guardarRectificacion();
      inicializarRectificacion();
    }
    
    // Guarda el array "rectificaciones" en localStorage.
    function guardarRectificacion() {
      localStorage.setItem("rectificaciones", JSON.stringify(rectificaciones));
    }
    
    // Funciones para mostrar y ocultar el modal de exportaci√≥n.
    function mostrarOpcionesGuardar() {
      document.getElementById("modalGuardar").style.display = "block";
    }
    
    function cerrarModalGuardar() {
      document.getElementById("modalGuardar").style.display = "none";
    }
    
    // Exporta a PDF usando jsPDF y autoTable.
    function exportarPDF() {
      cerrarModalGuardar();
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF('l', 'pt', 'a4');
      doc.text("Rectificaciones", 40, 40);
      const columns = ["Elemento", "Tipo", "Nombre", "Cantidad", "Ancho", "Alto", "Asentamiento", "m¬≤", "mL"];
      const rows = rectificaciones.map(item => [
        item.elemento || "Seleccione",
        item.tipo || "Seleccione",
        item.nombre,
        item.cantidad,
        item.ancho,
        item.alto,
        item.asentamiento,
        item.m2,
        item.ml
      ]);
      doc.autoTable({
        head: [columns],
        body: rows,
        startY: 60
      });
      doc.save("rectificaciones.pdf");
    }
    
    // Exporta a Excel usando SheetJS.
    function exportarExcel() {
      cerrarModalGuardar();
      const wb = XLSX.utils.book_new();
      const ws_data = [["Elemento", "Tipo", "Nombre", "Cantidad", "Ancho", "Alto", "Asentamiento", "m¬≤", "mL"]];
      rectificaciones.forEach(item => {
        ws_data.push([
          item.elemento || "Seleccione",
          item.tipo || "Seleccione",
          item.nombre,
          item.cantidad,
          item.ancho,
          item.alto,
          item.asentamiento,
          item.m2,
          item.ml
        ]);
      });
      const ws = XLSX.utils.aoa_to_sheet(ws_data);
      XLSX.utils.book_append_sheet(wb, ws, "Rectificaciones");
      XLSX.writeFile(wb, "rectificaciones.xlsx");
    }
    
    // Exporta el HTML completo actual a un archivo HTML.
    function exportarHTML() {
      cerrarModalGuardar();
      document.querySelectorAll("input").forEach(input => {
        input.setAttribute("value", input.value);
      });
      const htmlCode = document.documentElement.outerHTML;
      const blob = new Blob([htmlCode], { type: "text/html" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "rectificacion.html";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }
    
    /* ------------------------------------------------- */
    /*            Funci√≥n de Navegaci√≥n                  */
    /* ------------------------------------------------- */
    function mostrarSeccion(seccion) {
      document.querySelectorAll(".container").forEach(div => div.classList.remove("active"));
      document.getElementById(seccion).classList.add("active");
    }
    
    // Inicializaci√≥n de la secci√≥n Rectificador.
    inicializarRectificacion();
  </script>

</body></html>
